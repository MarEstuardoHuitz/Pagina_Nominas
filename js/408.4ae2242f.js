"use strict";(globalThis["webpackChunkquasar_project"]=globalThis["webpackChunkquasar_project"]||[]).push([[408],{2408:(e,l,a)=>{a.r(l),a.d(l,{default:()=>R});var o=a(9835);const n={class:"row"},i={class:"col-xs-3 col-md-2 q-pa-sm"},s={class:"col-xs-9 col-md-5 q-pa-sm"},r={class:"col-xs-9 col-md-5 q-pa-sm"},t={class:"col-xs-4 col-sm-2 col-md-2 q-pa-sm"},d={class:"col-xs-8 col-sm-10 col-md-3 q-pa-sm"},u={style:{height:"500px"}};function c(e,l,a,c,m,p){const g=(0,o.up)("q-input"),v=(0,o.up)("q-toggle"),b=(0,o.up)("q-btn"),f=(0,o.up)("q-select"),h=(0,o.up)("q-form"),y=(0,o.up)("q-icon"),w=(0,o.up)("q-table"),U=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(U,{padding:""},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{onSubmit:e.onSubmit,class:"q-gutter-md",onReset:e.clear},{default:(0,o.w5)((()=>[(0,o._)("div",n,[(0,o._)("div",i,[(0,o.Wm)(g,{rounded:"",outlined:"",modelValue:e.codigo,"onUpdate:modelValue":l[0]||(l[0]=l=>e.codigo=l),type:"number",label:"Código",disable:""},null,8,["modelValue"])]),(0,o._)("div",s,[(0,o.Wm)(g,{rounded:"",outlined:"",modelValue:e.nombre,"onUpdate:modelValue":l[1]||(l[1]=l=>e.nombre=l),type:"text",label:"Nombre",counter:"",rules:[e=>e.length<=40||"El nombre no puede ser mayor a 40 caracteres"]},null,8,["modelValue","rules"])]),(0,o._)("div",r,[(0,o.Wm)(g,{rounded:"",outlined:"",modelValue:e.apellido,"onUpdate:modelValue":l[2]||(l[2]=l=>e.apellido=l),type:"text",label:"Apellido",counter:"",rules:[e=>e.length<=40||"El apellido no puede ser mayor a 40 caracteres"]},null,8,["modelValue","rules"])]),(0,o._)("div",t,[(0,o.Wm)(v,{modelValue:e.estado,"onUpdate:modelValue":l[3]||(l[3]=l=>e.estado=l),color:"green",label:"Estado","left-label":""},null,8,["modelValue"])]),(0,o._)("div",d,[(0,o.Wm)(g,{rounded:"",outlined:"",modelValue:e.pass,"onUpdate:modelValue":l[4]||(l[4]=l=>e.pass=l),type:"text",label:"Contraseña",counter:"",rules:[e=>e.length<=15||"La contraseña no puede ser mayor a 15 caracteres",e=>e.length>=6||"La contraseña debe ser mayor a 6 caracteres"]},{append:(0,o.w5)((()=>[e.codigo?((0,o.wg)(),(0,o.j4)(b,{key:0,round:"",dense:"",flat:"",icon:"save",onClick:e.cambiarClave},null,8,["onClick"])):(0,o.kq)("",!0)])),_:1},8,["modelValue","rules"])]),(0,o.Wm)(f,{class:"col-xs-12 col-sm-2 q-pa-sm",rounded:"",outlined:"",modelValue:e.rol,"onUpdate:modelValue":l[5]||(l[5]=l=>e.rol=l),options:e.roles,label:"Rol / Permiso",filled:""},null,8,["modelValue","options"]),(0,o.Wm)(g,{class:"q-pa-xs col-sm-4 q-pa-sm",rounded:"",outlined:"",modelValue:e.email,"onUpdate:modelValue":l[6]||(l[6]=l=>e.email=l),type:"email",label:"Email",counter:""},null,8,["modelValue"])]),(0,o._)("div",null,[(0,o.Wm)(b,{label:null===e.codigo?"Guardar":"Actualizar",type:"submit",color:"primary"},null,8,["label"]),(0,o.Wm)(b,{label:"Limpiar",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])])),_:1},8,["onSubmit","onReset"]),(0,o._)("div",u,[(0,o.Wm)(w,{class:"full-height",title:"Usuarios",rows:e.usuarios,columns:e.columns,filter:e.filter,pagination:{rowsPerPage:0},onRowClick:e.selectUsuario},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(g,{for:"pos-buscar-detalles",borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":l[7]||(l[7]=l=>e.filter=l),placeholder:"Usuarios del Sistema",clearable:""},{append:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"search"})])),_:1},8,["modelValue"])])),"top-left":(0,o.w5)((()=>[])),_:1},8,["rows","columns","filter","onRowClick"])])])),_:1})}var m=a(6646),p=a(7234),g=a(9302),v=a(4136),b=a(8651),f=a(499),h=function(e,l,a,o){function n(e){return e instanceof a?e:new a((function(l){l(e)}))}return new(a||(a=Promise))((function(a,i){function s(e){try{t(o.next(e))}catch(l){i(l)}}function r(e){try{t(o["throw"](e))}catch(l){i(l)}}function t(e){e.done?a(e.value):n(e.value).then(s,r)}t((o=o.apply(e,l||[])).next())}))};const y=[{name:"Codigo",label:"Código",field:"id",align:"center"},{name:"Nombres",label:"Nombres",field:"nombre",align:"center"},{name:"Apellidos",label:"Apellidos",field:"apellido",align:"center"},{name:"Email",label:"Email",field:"email",align:"center"},{name:"Estado",label:"Estado",field:"activo",align:"center"},{name:"Rol",label:"Rol",field:"rol",align:"center"}],w=(0,o.aZ)({name:"UsuariosPage",setup(){const e=(0,g.Z)(),l=(0,f.iH)(null),a=(0,f.iH)(null),o=(0,f.iH)(null),n=(0,f.iH)(null),i=(0,f.iH)(!0),s=(0,f.iH)(""),r=(0,f.iH)(["Administrador","Usuario","Colaborador"]),t=(0,f.iH)("Usuario"),d=(0,f.iH)(""),u=(0,f.iH)([]),c=(e,l,a)=>{let o=void 0!==l?l(e,a):e;return o=void 0===o||null===o?"":String(o),o=o.split('"').join('""'),`"${o}"`},w=()=>{const l=[y.map((e=>c(e.label,void 0,void 0)))].concat(u.value.map((e=>y.map((l=>c("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format,e))).join(",")))).join("\r\n"),a=(0,m.Z)("table-export.csv",l,"text/csv");!0!==a&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},U=()=>h(this,void 0,void 0,(function*(){if(!l.value)return;if(!s.value)return;const a=yield(0,b.pW)("Confirmacion","Esta seguro de cambiar la clave al usuario?",{});a&&(e.loading.show({spinner:p.Z,spinnerColor:"yellow",spinnerSize:140,message:"Cargando...",messageColor:"black"}),yield v.api.post(v.endPoints.USUARIOS+"/clave",{id:l.value,clave:s.value}).then((e=>{(0,b.dF)("Proceso Correcto")})).catch((e=>{(0,b.L1)(e)})).finally((()=>{e.loading.hide()})))})),C=()=>h(this,void 0,void 0,(function*(){e.loading.show({spinner:p.Z,spinnerColor:"yellow",spinnerSize:140,message:"Cargando...",messageColor:"black"}),yield v.api.get(v.endPoints.USUARIOS).then((e=>{u.value=e.data})).catch((e=>{(0,b.L1)(e,{mensaje:e.response.data.mensaje})})).finally((()=>{e.loading.hide()}))})),V=()=>{let r={id:l.value,nombre:a.value,apellido:n.value,contraseña:s.value,email:o.value,activo:i.value,rol:t.value};null===l.value?(e.loading.show({spinner:p.Z,spinnerColor:"yellow",spinnerSize:140,message:"Cargandp...",messageColor:"black"}),v.api.post(v.endPoints.USUARIOS,r).then((e=>h(this,void 0,void 0,(function*(){(0,b.dF)("Usuario guardado"),S(),yield C()})))).catch((e=>{(0,b.L1)(e,{mensaje:e.response.data.mensaje})})).finally((()=>{e.loading.hide()}))):(e.loading.show({spinner:p.Z,spinnerColor:"yellow",spinnerSize:140,message:"Cargandp...",messageColor:"black"}),v.api.put(v.endPoints.USUARIOS,r).then((e=>h(this,void 0,void 0,(function*(){(0,b.dF)("Usuario guardado"),S(),yield C()})))).catch((e=>{(0,b.L1)(e,{mensaje:e.response.data.mensaje})})).finally((()=>{e.loading.hide()})))},q=(e,s,r)=>{l.value=s.id,a.value=s.nombre,n.value=s.apellido,i.value=s.activo,t.value=s.rol,o.value=s.email},S=()=>{l.value=null,a.value="",n.value="",o.value="",i.value=!0,s.value="",t.value="Usuario"};return{getUsuarios:C,onSubmit:V,selectUsuario:q,clear:S,usuarios:u,columns:y,codigo:l,nombre:a,apellido:n,estado:i,pass:s,roles:r,rol:t,email:o,filter:d,exportTable:w,cambiarClave:U}},created(){this.getUsuarios()}});var U=a(1639),C=a(9885),V=a(8326),q=a(3119),S=a(3175),x=a(8879),Z=a(6384),_=a(7580),k=a(2857),W=a(9984),j=a.n(W);const P=(0,U.Z)(w,[["render",c]]),R=P;j()(w,"components",{QPage:C.Z,QForm:V.Z,QInput:q.Z,QToggle:S.Z,QBtn:x.Z,QSelect:Z.Z,QTable:_.Z,QIcon:k.Z})}}]);